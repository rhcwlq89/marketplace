{
  "info": {
    "_postman_id": "marketplace-api-collection",
    "name": "Marketplace API",
    "description": "대용량 마켓플레이스 API 테스트 컬렉션\n\n## 테스트 순서\n1. Auth > 회원가입 (Buyer/Seller)\n2. Auth > 로그인\n3. 각 API 테스트\n\n## 기본 계정 (Docker 환경)\n- Buyer: buyer@example.com / password123\n- Seller: seller@example.com / password123\n- Admin: admin@example.com / admin123",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080",
      "type": "string"
    },
    {
      "key": "accessToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "refreshToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "productId",
      "value": "1",
      "type": "string"
    },
    {
      "key": "orderId",
      "value": "1",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Auth",
      "description": "인증 관련 API",
      "item": [
        {
          "name": "회원가입 (Buyer)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"newbuyer@example.com\",\n    \"password\": \"password123\",\n    \"name\": \"New Buyer\",\n    \"phone\": \"010-1234-5678\",\n    \"role\": \"BUYER\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/signup",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "signup"]
            },
            "description": "구매자 회원가입"
          }
        },
        {
          "name": "회원가입 (Seller)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"newseller@example.com\",\n    \"password\": \"password123\",\n    \"name\": \"New Seller\",\n    \"phone\": \"010-9876-5432\",\n    \"role\": \"SELLER\",\n    \"businessNumber\": \"123-45-67890\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/signup",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "signup"]
            },
            "description": "판매자 회원가입 (사업자번호 필요)"
          }
        },
        {
          "name": "로그인 (Buyer)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.data && jsonData.data.accessToken) {",
                  "    pm.collectionVariables.set('accessToken', jsonData.data.accessToken);",
                  "    pm.collectionVariables.set('refreshToken', jsonData.data.refreshToken);",
                  "    console.log('Token saved successfully');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"buyer@example.com\",\n    \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "login"]
            },
            "description": "구매자 로그인 - 토큰이 자동으로 저장됩니다"
          }
        },
        {
          "name": "로그인 (Seller)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.data && jsonData.data.accessToken) {",
                  "    pm.collectionVariables.set('accessToken', jsonData.data.accessToken);",
                  "    pm.collectionVariables.set('refreshToken', jsonData.data.refreshToken);",
                  "    console.log('Token saved successfully');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"seller@example.com\",\n    \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "login"]
            },
            "description": "판매자 로그인 - 토큰이 자동으로 저장됩니다"
          }
        },
        {
          "name": "로그인 (Admin)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.data && jsonData.data.accessToken) {",
                  "    pm.collectionVariables.set('accessToken', jsonData.data.accessToken);",
                  "    pm.collectionVariables.set('refreshToken', jsonData.data.refreshToken);",
                  "    console.log('Token saved successfully');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"admin@example.com\",\n    \"password\": \"admin123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "login"]
            },
            "description": "관리자 로그인 - 토큰이 자동으로 저장됩니다"
          }
        },
        {
          "name": "토큰 갱신",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.data && jsonData.data.accessToken) {",
                  "    pm.collectionVariables.set('accessToken', jsonData.data.accessToken);",
                  "    pm.collectionVariables.set('refreshToken', jsonData.data.refreshToken);",
                  "    console.log('Token refreshed successfully');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"refreshToken\": \"{{refreshToken}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/refresh",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "refresh"]
            },
            "description": "리프레시 토큰으로 새 액세스 토큰 발급"
          }
        },
        {
          "name": "로그아웃",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"accessToken\": \"{{accessToken}}\",\n    \"refreshToken\": \"{{refreshToken}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/logout",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "logout"]
            },
            "description": "로그아웃 - 토큰이 블랙리스트에 추가됩니다"
          }
        }
      ]
    },
    {
      "name": "Members",
      "description": "회원 관련 API",
      "item": [
        {
          "name": "내 정보 조회",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/members/me",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "members", "me"]
            },
            "description": "현재 로그인한 사용자 정보 조회"
          }
        },
        {
          "name": "내 정보 수정",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Updated Name\",\n    \"phone\": \"010-1111-2222\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/members/me",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "members", "me"]
            },
            "description": "현재 로그인한 사용자 정보 수정"
          }
        },
        {
          "name": "[Admin] 회원 목록 조회",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/admin/members",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "admin", "members"]
            },
            "description": "관리자 전용 - 전체 회원 목록 조회"
          }
        }
      ]
    },
    {
      "name": "Categories",
      "description": "카테고리 관련 API",
      "item": [
        {
          "name": "카테고리 목록 조회",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/categories",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "categories"]
            },
            "description": "전체 카테고리 목록 조회 (인증 불필요)"
          }
        },
        {
          "name": "[Admin] 카테고리 등록",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"New Category\",\n    \"parentId\": null,\n    \"displayOrder\": 10\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/admin/categories",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "admin", "categories"]
            },
            "description": "관리자 전용 - 새 카테고리 등록"
          }
        }
      ]
    },
    {
      "name": "Products",
      "description": "상품 관련 API",
      "item": [
        {
          "name": "상품 목록 조회",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/products?page=0&size=20",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products"],
              "query": [
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "20"
                },
                {
                  "key": "keyword",
                  "value": "",
                  "disabled": true
                },
                {
                  "key": "categoryId",
                  "value": "",
                  "disabled": true
                },
                {
                  "key": "minPrice",
                  "value": "",
                  "disabled": true
                },
                {
                  "key": "maxPrice",
                  "value": "",
                  "disabled": true
                },
                {
                  "key": "status",
                  "value": "ON_SALE",
                  "disabled": true
                },
                {
                  "key": "sellerId",
                  "value": "",
                  "disabled": true
                }
              ]
            },
            "description": "상품 목록 조회 (필터 및 페이징 지원)"
          }
        },
        {
          "name": "상품 목록 조회 (커서 기반)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/products/cursor?limit=20",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products", "cursor"],
              "query": [
                {
                  "key": "limit",
                  "value": "20"
                },
                {
                  "key": "cursor",
                  "value": "",
                  "disabled": true
                },
                {
                  "key": "keyword",
                  "value": "",
                  "disabled": true
                },
                {
                  "key": "categoryId",
                  "value": "",
                  "disabled": true
                }
              ]
            },
            "description": "커서 기반 페이지네이션 - 대용량 데이터에 효율적"
          }
        },
        {
          "name": "상품 상세 조회",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/products/{{productId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products", "{{productId}}"]
            },
            "description": "상품 상세 정보 조회"
          }
        },
        {
          "name": "인기 상품 목록",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/products/popular",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products", "popular"]
            },
            "description": "판매량 기준 인기 상품 목록"
          }
        },
        {
          "name": "[Seller] 상품 등록",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.data && jsonData.data.id) {",
                  "    pm.collectionVariables.set('productId', jsonData.data.id);",
                  "    console.log('Product ID saved: ' + jsonData.data.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"New Product\",\n    \"description\": \"This is a new product description\",\n    \"price\": 50000,\n    \"stockQuantity\": 100,\n    \"categoryId\": 1,\n    \"status\": \"ON_SALE\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/products",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products"]
            },
            "description": "판매자 전용 - 새 상품 등록\n\nstatus 옵션: DRAFT, ON_SALE, SOLD_OUT, DISCONTINUED"
          }
        },
        {
          "name": "[Seller] 상품 수정",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Updated Product Name\",\n    \"price\": 45000,\n    \"stockQuantity\": 50\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/products/{{productId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products", "{{productId}}"]
            },
            "description": "판매자 전용 - 본인 상품 수정"
          }
        },
        {
          "name": "[Seller] 상품 삭제",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/products/{{productId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products", "{{productId}}"]
            },
            "description": "판매자 전용 - 본인 상품 삭제"
          }
        },
        {
          "name": "[Seller] 상품 이미지 업로드",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "files",
                  "type": "file",
                  "src": []
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/products/{{productId}}/images",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products", "{{productId}}", "images"]
            },
            "description": "판매자 전용 - 상품 이미지 업로드 (multipart/form-data)"
          }
        }
      ]
    },
    {
      "name": "Orders",
      "description": "주문 관련 API",
      "item": [
        {
          "name": "[Buyer] 주문 생성",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.data && jsonData.data.id) {",
                  "    pm.collectionVariables.set('orderId', jsonData.data.id);",
                  "    console.log('Order ID saved: ' + jsonData.data.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"orderItems\": [\n        {\n            \"productId\": 1,\n            \"quantity\": 2\n        },\n        {\n            \"productId\": 2,\n            \"quantity\": 1\n        }\n    ],\n    \"shippingAddress\": {\n        \"zipCode\": \"12345\",\n        \"address\": \"Seoul, Korea\",\n        \"addressDetail\": \"Apt 101\",\n        \"receiverName\": \"John Doe\",\n        \"receiverPhone\": \"010-1234-5678\"\n    }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/orders",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "orders"]
            },
            "description": "구매자 전용 - 새 주문 생성\n\n분산락과 원자적 재고 감소가 적용됩니다."
          }
        },
        {
          "name": "내 주문 목록 조회",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/orders?page=0&size=20",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "orders"],
              "query": [
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "20"
                }
              ]
            },
            "description": "현재 사용자의 주문 목록 조회"
          }
        },
        {
          "name": "주문 상세 조회",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/orders/{{orderId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "orders", "{{orderId}}"]
            },
            "description": "주문 상세 정보 조회"
          }
        },
        {
          "name": "[Buyer] 주문 취소",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/orders/{{orderId}}/cancel",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "orders", "{{orderId}}", "cancel"]
            },
            "description": "구매자 전용 - 주문 취소 (재고 복구됨)"
          }
        },
        {
          "name": "[Seller] 판매자 주문 목록",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/sellers/orders?page=0&size=20",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "sellers", "orders"],
              "query": [
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "20"
                }
              ]
            },
            "description": "판매자 전용 - 본인 상품에 대한 주문 목록"
          }
        },
        {
          "name": "[Seller] 배송 상태 변경",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"status\": \"SHIPPING\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/sellers/orders/{{orderId}}/status",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "sellers", "orders", "{{orderId}}", "status"]
            },
            "description": "판매자 전용 - 주문 상태 변경\n\nstatus 옵션:\n- PENDING: 대기중\n- PAID: 결제완료\n- PREPARING: 준비중\n- SHIPPING: 배송중\n- DELIVERED: 배송완료\n- CANCELLED: 취소됨"
          }
        }
      ]
    },
    {
      "name": "Health & Monitoring",
      "description": "헬스체크 및 모니터링 API",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/actuator/health",
              "host": ["{{baseUrl}}"],
              "path": ["actuator", "health"]
            },
            "description": "애플리케이션 헬스 체크"
          }
        },
        {
          "name": "Prometheus Metrics",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/actuator/prometheus",
              "host": ["{{baseUrl}}"],
              "path": ["actuator", "prometheus"]
            },
            "description": "Prometheus 메트릭 (모니터링용)"
          }
        },
        {
          "name": "Application Info",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/actuator/info",
              "host": ["{{baseUrl}}"],
              "path": ["actuator", "info"]
            },
            "description": "애플리케이션 정보"
          }
        }
      ]
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{accessToken}}",
        "type": "string"
      }
    ]
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [""]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "pm.test('Response status code is successful', function () {",
          "    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
          "});"
        ]
      }
    }
  ]
}
